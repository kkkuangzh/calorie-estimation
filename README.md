# calorie-estimation

## 数据来源
从 www.bbcgoodfood.com 下载食物图像，对应的包含卡路里在内的营养信息以及食谱。
新加至12个种类， 包括。

## 预处理
提取出ingredient名称，转换成ingredient vector；
记录下不完整的nutrients index
对于图像，则resize到255，255，并将像素值归一化到0~1以便于网络学习。

## 模型训练
基于Dense121的多任务模型，网络输出为回归问题（营养物，用mse做损失函数）和分类问题（原料，用分类熵做损失函数）。
使用flow_from_dataframe, 节约内存、标签对应、图像实时增强
在server训练27代，验证集误差mse在5000左右，还是很高的。（其实没有办法降低？）


## 评价指标
多任务是能够提升准确率，考虑到主要目的是准确预测卡路里含量，因此优先考虑对卡路里含量的预测准确。

# TODO
* 更多的训练数据（更多种类，每类1000图像？）
* 卡路里计算方式（当前是网站给定 -> 通过原料来计算卡路里有多少）
  + 提取出每个原料以及对应的量词描述（1 tbsp / 1 cup / 1 middle-size etc.）
  + 将量词转化成各个原料的重量（找数据库）（*数据库里没有原料怎么找近似的？*）
  + 找各个原料对应的卡路里，记录下总的卡路里=recipe calorie
* 数据增强避免过拟合 （完成！）
* app开发

